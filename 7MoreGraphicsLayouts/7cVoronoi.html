<!-- https://bl.ocks.org/mbostock/4060366 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>D3. js Essential Training for Data Scientist</title>
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.js"></script>
    <style>
        g.polygons path {
            fill: white;
            stroke: lightsteelblue;
        }

        /* g.polygons path:hover {
            fill: yellow;
        } */

        g.fuel circle {
            fill: steelblue;
        }
    </style>
</head>

<body>
    <!-- change script -->
    <script>
        // not impressed by callFunction and svg redrawing everytime on window resize...
        // responsive svg is via no height or width attributes. But these are needed for drawing...
        d3.select(window).on("resize", callFunction);
        callFunction();

        function callFunction() {

            var tooltip = d3.select("body").append("div").style("opacity", 0).style("position", "absolute");
            var svgtest = d3.select("body").select("svg");
            if (!svgtest.empty()) {
                svgtest.remove();
            }
            console.log(window.innerWidth); //from ex 9b Responsive
            var width = window.innerWidth; // 9b
            var height = window.innerHeight; // 9b
            // var width = 960;
            // var height = 500;

            // makes array of 100 sequential numbers, 0â€“99 
            // map is like foreach loop
            // creating array to hold x and y coords
            var vertices = d3.range(100).map(function (d) {
                return [
                    Math.random() * width,
                    Math.random() * height
                ];
            });
            // console.log(vertices);

            var voronoi = d3.voronoi().size([width, height]);
            var svg = d3.select('body').append('svg')
                .attr('width', '100%').attr('height', '100%');

            svg.append('g').attr('class', 'polygons')
                .selectAll('path')
                .data(voronoi.polygons(vertices)) // generate polygons on-the-fly
                .enter().append('path')
                .attr('d', function (d) {
                    return 'M' + d.join('L') + 'Z';
                })
                .on("mousemove", function (d) { // 9d
                    tooltip.style("opacity", 1)
                        .style("left", d3.event.pageX + "px")
                        .style("top", d3.event.pageY + "px");
                    // console.log(d);
                    console.log(d3.event);
                    tooltip.html("Number of sides: " + d.length)
                });
            // .on("mousemove", function () { // 9d
            //     this.style.fill = "red";
            // })
            // .on("mouseout", function () {
            //     this.style.fill = "white";
            // });

            svg.append('g')
                .attr('class', 'fuel')
                .selectAll('circle')
                .data(vertices).enter().append('circle')
                .attr('cx', function (d) {
                    return d[0];
                })
                .attr('cy', function (d) {
                    return d[1];
                })
                .attr('r', 2.5);
        }
    </script>
</body>

</html>